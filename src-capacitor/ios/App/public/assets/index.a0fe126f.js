import{m as k,r as l,f as v,p as _,q as p,k as u,a6 as E,Q as U,x as s,a7 as I,u as D,N as T,ad as B,j as L,d as S,aa as $,F as w}from"./index.e198538d.js";import{_ as x}from"./DetailLayout.4e603666.js";import{D as C}from"./didperu-dark.b27a34e1.js";import{_ as N}from"./HeaderWithBackBtn.9bfa7eee.js";import{b as V,s as z,u as F}from"./EventsActions.7ae98389.js";import{g as O}from"./auth.37a4a2c2.js";import"./QImg.cf8c1307.js";import"./BackButton.5098c60e.js";/* empty css               *//* empty css                */import"./Events.fe5df1d9.js";const Q={class:"Event__title"},j={class:"Event__date"},q={class:"Event__detail"},A={class:"Event__description"},P=I(" Participar "),R=I(" Desuscribirse "),G=k({__name:"Event.layout",props:{event:null,userInscriptionId:null,isLoading:{type:Boolean}},emits:["subscribeUserToEvent","unsubscribeUserToEvent"],setup(n){const a=n,e=l();return e.value=new Date(a.event.date).toLocaleString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}),(i,t)=>(v(),_(s(x),{class:"Event__container",image_url:n.event.image_url,fallback:s(C)},{"custom-name":p(()=>[u("span",Q,[u("span",null,E(n.event.title),1),u("span",j,E(e.value),1)])]),default:p(()=>[u("div",q,[u("div",A,E(n.event.description),1),n.userInscriptionId?(v(),_(U,{key:1,onClick:t[1]||(t[1]=d=>i.$emit("unsubscribeUserToEvent",n.userInscriptionId)),class:"Event__btn-participate",color:"primary",size:"lg","no-caps":"",loading:n.isLoading},{default:p(()=>[R]),_:1},8,["loading"])):(v(),_(U,{key:0,onClick:t[0]||(t[0]=d=>i.$emit("subscribeUserToEvent")),class:"Event__btn-participate",color:"primary",size:"lg","no-caps":"",loading:n.isLoading},{default:p(()=>[P]),_:1},8,["loading"]))])]),_:1},8,["image_url","fallback"]))}}),H=()=>{const n=D(),a=l(),e=l(!1),i=n.params.event,t=l();return{userInscriptionId:t,event:a,isLoading:e,eventId:i,getEventDetail:async(r,c)=>{e.value=!0,await V(r,c).then(o=>{var g;const m=o.inscriptions||[];t.value=(g=m[0])==null?void 0:g.id,a.value=o,e.value=!1})},onUnsubscribeUserToEvent:r=>{e.value=!0,F(r).then(()=>{t.value=void 0}).catch(c=>{T.create({message:"Ocurrio un error, por favor vuelve a intentar.",type:"negative"})}).finally(()=>{e.value=!1})},onSubscribeUserToEvent:(r,c)=>{e.value=!0,z(r,c).then(o=>{t.value=o}).catch(o=>{T.create({message:"Ocurrio un error, por favor vuelve a intentar.",type:"negative"})}).finally(()=>{e.value=!1})}}},ae=k({__name:"index",async setup(n){let a,e;const{event:i,eventId:t,userInscriptionId:d,isLoading:f,onSubscribeUserToEvent:y,onUnsubscribeUserToEvent:r,getEventDetail:c}=H(),o=l(O()),m=l(o.value.member_info.id);return[a,e]=B(()=>c(m.value,t)),await a,e(),(g,b)=>(v(),L(w,null,[S(s(N),{class:"Event__btnBack","show-back-btn":"","label-back":"Eventos"}),s(i)?(v(),_(G,{key:0,event:s(i),"user-inscription-id":s(d),"is-loading":s(f),onUnsubscribeUserToEvent:b[0]||(b[0]=h=>s(r)(h)),onSubscribeUserToEvent:b[1]||(b[1]=()=>s(y)(m.value,s(t)))},null,8,["event","user-inscription-id","is-loading"])):$("",!0)],64))}});export{ae as default};
